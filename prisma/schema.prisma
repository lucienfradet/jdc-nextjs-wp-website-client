// This is your Prisma schema file,
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Customer {
  id               Int      @id @default(autoincrement())
  email            String   @unique
  firstName        String
  lastName         String
  phone            String?
  address1         String?
  address2         String?
  city             String?
  state            String?
  postalCode       String?
  country          String?  @default("CA")
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  orders           Order[]
}

model Order {
  id               String    @id @default(uuid())
  orderNumber      String    @unique
  customerId       Int
  customer         Customer  @relation(fields: [customerId], references: [id])
  status           String    @default("pending")
  paymentStatus    String    @default("pending")
  paymentMethod    String
  paymentIntentId  String?
  subtotal         Decimal   @db.Decimal(10, 2)
  tax              Decimal   @db.Decimal(10, 2)
  shipping         Decimal   @db.Decimal(10, 2)
  total            Decimal   @db.Decimal(10, 2)
  deliveryMethod   String    @default("shipping")
  pickupLocationId Int?
  pickupLocation   PickupLocation? @relation(fields: [pickupLocationId], references: [id])
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  items            OrderItem[]
}

model OrderItem {
  id          Int      @id @default(autoincrement())
  orderId     String
  order       Order    @relation(fields: [orderId], references: [id])
  productId   Int
  name        String
  price       Decimal  @db.Decimal(10, 2)
  quantity    Int
  subtotal    Decimal  @db.Decimal(10, 2)
  tax         Decimal  @db.Decimal(10, 2)
  total       Decimal  @db.Decimal(10, 2)
  createdAt   DateTime @default(now())
}

model PickupLocation {
  id                  Int      @id @default(autoincrement())
  name                String
  address             String
  city                String
  state               String
  postalCode          String
  country             String   @default("CA")
  description         String?  @db.Text
  isActive            Boolean  @default(true)
  orders              Order[]
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

model PaymentIntent {
  id                String    @id
  orderNumber       String
  amount            Decimal   @db.Decimal(10, 2)
  currency          String    @default("cad")
  status            String    @default("created")
  paymentMethod     String?
  clientSecret      String
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
}
